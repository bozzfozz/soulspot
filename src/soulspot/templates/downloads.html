{% extends "base.html" %}

{% block title %}Downloads - SoulSpot Bridge{% endblock %}

{% block content %}
<div class="downloads">
    <h1>Downloads</h1>

    <div class="filters">
        <button class="btn btn-small" 
                hx-get="/api/v1/downloads?status=all"
                hx-target="#downloads-list">
            All
        </button>
        <button class="btn btn-small" 
                hx-get="/api/v1/downloads?status=queued"
                hx-target="#downloads-list">
            Queued
        </button>
        <button class="btn btn-small" 
                hx-get="/api/v1/downloads?status=downloading"
                hx-target="#downloads-list">
            Downloading
        </button>
        <button class="btn btn-small" 
                hx-get="/api/v1/downloads?status=completed"
                hx-target="#downloads-list">
            Completed
        </button>
        <button class="btn btn-small" 
                hx-get="/api/v1/downloads?status=failed"
                hx-target="#downloads-list">
            Failed
        </button>
    </div>

    <div class="downloads-list" id="downloads-list">
        {% if downloads %}
            {% for download in downloads %}
            <div class="download-card">
                <div class="download-info">
                    <h3>{{ download.track_name }}</h3>
                    <p>Artist: {{ download.artist_name }}</p>
                    <span class="status status-{{ download.status }}">{{ download.status }}</span>
                </div>
                <div class="download-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: {{ download.progress or 0 }}%"></div>
                    </div>
                    <span class="progress-text">{{ download.progress or 0 }}%</span>
                </div>
                <div class="download-actions">
                    {% if download.status == 'failed' %}
                    <button class="btn btn-small" 
                            hx-post="/api/v1/downloads/{{ download.id }}/retry"
                            hx-swap="outerHTML">
                        Retry
                    </button>
                    {% endif %}
                    {% if download.status in ['queued', 'downloading'] %}
                    <button class="btn btn-small btn-danger" 
                            hx-post="/api/v1/downloads/{{ download.id }}/cancel"
                            hx-swap="outerHTML">
                        Cancel
                    </button>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        {% else %}
            <p class="empty-state">No downloads to show.</p>
        {% endif %}
    </div>
</div>
{% endblock %}
