{# Hey future me - Artist detail page!
   Shows artist image from Spotify (image_url) or letter fallback.
   Album grid now shows artwork_url from Spotify CDN if available.
   Tracks table has status badges and edit buttons. #}

{% extends "base.html" %}

{% block title %}{{ artist.name }} - Artists - SoulSpot{% endblock %}

{% block content %}
<!-- Breadcrumb -->
<nav style="margin-bottom: var(--space-4);">
    <ol style="display: flex; align-items: center; gap: var(--space-2); font-size: var(--font-size-sm);">
        <li><a href="/library" style="color: var(--accent-primary);">Library</a></li>
        <li style="color: var(--text-muted);"><i class="bi bi-chevron-right" style="font-size: 0.6rem; margin: 0 var(--space-2);"></i></li>
        <li><a href="/library/artists" style="color: var(--accent-primary);">Artists</a></li>
        <li style="color: var(--text-muted);"><i class="bi bi-chevron-right" style="font-size: 0.6rem; margin: 0 var(--space-2);"></i>{{ artist.name }}</li>
    </ol>
</nav>

<!-- Artist Header -->
<div style="display: flex; align-items: center; gap: var(--space-6); margin-bottom: var(--space-8);">
    <div class="artist-avatar-large" {% if not artist.image_url %}style="background: linear-gradient(135deg, #a855f7, #7c3aed);"{% endif %}>
        {% if artist.image_url %}
        <img src="{{ artist.image_url }}" alt="{{ artist.name }}" loading="lazy">
        {% else %}
        <span style="font-size: 3rem; font-weight: var(--font-weight-bold); color: white;">
            {{ artist.name[0]|upper }}
        </span>
        {% endif %}
    </div>
    <div>
        <h1 style="font-size: var(--font-size-3xl); margin-bottom: var(--space-2);">{{ artist.name }}</h1>
        {% if artist.disambiguation %}
        <div style="font-size: var(--font-size-sm); color: var(--text-muted); opacity: 0.7; margin-bottom: var(--space-2);">{{ artist.disambiguation }}</div>
        {% endif %}
        <div style="display: flex; gap: var(--space-4); color: var(--text-muted); font-size: var(--font-size-sm); margin-bottom: var(--space-3);">
            <span><i class="bi bi-disc" style="margin-right: var(--space-2);"></i>{{ artist.albums|length }} album{{ 's' if artist.albums|length != 1 else '' }}</span>
            <span><i class="bi bi-music-note" style="margin-right: var(--space-2);"></i>{{ artist.track_count }} track{{ 's' if artist.track_count != 1 else '' }}</span>
        </div>
        {# Hey future me - External service links! MusicBrainz and Spotify. 
           These open in new tabs so users can explore metadata sources. #}
        <div style="display: flex; gap: var(--space-3); flex-wrap: wrap;">
            {% if artist.musicbrainz_id %}
            <a href="https://musicbrainz.org/artist/{{ artist.musicbrainz_id }}" 
               target="_blank" 
               rel="noopener noreferrer"
               class="external-link-badge musicbrainz"
               title="View on MusicBrainz">
                <i class="bi bi-box-arrow-up-right"></i> MusicBrainz
            </a>
            {% endif %}
            {% if artist.spotify_uri %}
            <a href="https://open.spotify.com/artist/{{ artist.spotify_uri.replace('spotify:artist:', '') }}" 
               target="_blank" 
               rel="noopener noreferrer"
               class="external-link-badge spotify"
               title="Open in Spotify">
                <i class="bi bi-spotify"></i> Spotify
            </a>
            {% endif %}
        </div>
    </div>
</div>

<!-- Albums Section -->
<div class="card" style="padding: var(--space-6); margin-bottom: var(--space-6);">
    <h2 style="font-size: var(--font-size-xl); font-weight: var(--font-weight-bold); margin-bottom: var(--space-5);">Albums</h2>
    {% if artist.albums %}
    <div class="albums-grid">
        {% for album in artist.albums %}
        <a href="/library/albums/{{ album.id }}" class="album-card">
            <div class="album-cover">
                {% if album.artwork_url %}
                <img src="{{ album.artwork_url }}" alt="{{ album.title }}" loading="lazy">
                {% else %}
                <i class="bi bi-disc"></i>
                {% endif %}
            </div>
            <h3 class="album-title" title="{{ album.title }}">{{ album.title }}</h3>
            <div class="album-meta">
                <span>{{ album.track_count }} tracks</span>
                {% if album.year %}<span>{{ album.year }}</span>{% endif %}
            </div>
        </a>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-state-small">
        <i class="bi bi-disc"></i>
        <p>No albums found for this artist.</p>
    </div>
    {% endif %}
</div>

<!-- Hey future me - All Tracks section removed Dec 2025!
     Tracks are already shown inside albums, so this was redundant.
     Users can click on an album to see all tracks in that album. -->

<!-- Metadata Modal Container -->
<div id="metadata-modal"></div>
{% endblock %}

{% block extra_scripts %}
<style>
    .artist-avatar-large {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
        overflow: hidden;
        box-shadow: var(--shadow-lg);
    }
    .artist-avatar-large img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    .albums-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: var(--space-4);
    }
    .album-card {
        background: var(--bg-tertiary);
        border-radius: var(--radius-lg);
        padding: var(--space-4);
        text-decoration: none;
        color: var(--text-primary);
        transition: transform var(--transition-fast), box-shadow var(--transition-fast);
    }
    .album-card:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-lg);
    }
    .album-cover {
        aspect-ratio: 1;
        background: linear-gradient(135deg, #22c55e, #16a34a);
        border-radius: var(--radius-md);
        margin-bottom: var(--space-3);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2.5rem;
        color: rgba(255, 255, 255, 0.4);
        overflow: hidden;
    }
    .album-cover img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    .album-title {
        font-size: var(--font-size-sm);
        font-weight: var(--font-weight-semibold);
        margin-bottom: var(--space-1);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    .album-meta {
        display: flex;
        justify-content: space-between;
        font-size: var(--font-size-xs);
        color: var(--text-muted);
    }
    .data-table {
        width: 100%;
        border-collapse: collapse;
    }
    .data-table th {
        padding: var(--space-3) var(--space-4);
        text-align: left;
        font-size: var(--font-size-xs);
        font-weight: var(--font-weight-medium);
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.05em;
        background: var(--bg-tertiary);
    }
    .data-table td {
        padding: var(--space-3) var(--space-4);
        border-bottom: 1px solid var(--border-primary);
        font-size: var(--font-size-sm);
    }
    .data-table tr:hover {
        background: var(--bg-hover);
    }
    .empty-state-small {
        text-align: center;
        padding: var(--space-6);
        color: var(--text-muted);
    }
    .empty-state-small i {
        font-size: var(--font-size-3xl);
        margin-bottom: var(--space-3);
        display: block;
        opacity: 0.5;
    }
    /* Hey future me - External service link badges!
       MusicBrainz = yellow/orange (their brand color)
       Spotify = green (their brand color) */
    .external-link-badge {
        display: inline-flex;
        align-items: center;
        gap: var(--space-2);
        padding: var(--space-1) var(--space-3);
        border-radius: var(--radius-full);
        font-size: var(--font-size-xs);
        font-weight: var(--font-weight-medium);
        text-decoration: none;
        transition: all var(--transition-fast);
    }
    .external-link-badge.musicbrainz {
        background: rgba(186, 83, 45, 0.15);
        color: #e69d3c;
        border: 1px solid rgba(186, 83, 45, 0.3);
    }
    .external-link-badge.musicbrainz:hover {
        background: rgba(186, 83, 45, 0.25);
        transform: translateY(-1px);
    }
    .external-link-badge.spotify {
        background: rgba(30, 215, 96, 0.15);
        color: #1ed760;
        border: 1px solid rgba(30, 215, 96, 0.3);
    }
    .external-link-badge.spotify:hover {
        background: rgba(30, 215, 96, 0.25);
        transform: translateY(-1px);
    }
</style>
{% endblock %}
